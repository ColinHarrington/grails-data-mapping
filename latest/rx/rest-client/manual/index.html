<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<meta name="author" content="Graeme Rocher">
<title>RxGORM for REST</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>RxGORM for REST</h1>
<div class="details">
<span id="author" class="author">Graeme Rocher</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#gettingStarted">Getting Started</a>
<ul class="sectlevel2">
<li><a href="#installation">Installation</a></li>
<li><a href="#creatingDomainClasses">Creating Domain Classes</a></li>
<li><a href="#crud">Performing CRUD Operations</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#_basic_configuration">Basic Configuration</a></li>
<li><a href="#singleHost">Single Host Connection Pooling</a></li>
<li><a href="#loadBalanced">Client Side Load Balancing</a></li>
</ul>
</li>
<li><a href="#domainClasses">Working with Domain Classes</a>
<ul class="sectlevel2">
<li><a href="#customTypes">Custom Types</a></li>
<li><a href="#identity">Identity Generation</a></li>
<li><a href="#uriTemplates">URI Templates</a></li>
<li><a href="#converting">Converting to and from JSON</a></li>
<li><a href="#dynamicAttributes">Dynamic Attributes</a></li>
<li><a href="#requestCustomization">Customizing the Request</a></li>
<li><a href="#interceptors">Request Interceptors</a></li>
<li><a href="#batchUpdates">Batch Updates</a></li>
</ul>
</li>
<li><a href="#associations">Modelling Associations</a>
<ul class="sectlevel2">
<li><a href="#embedded">Embedded</a></li>
<li><a href="#hasOne">Single Ended Associations</a></li>
<li><a href="#hasMany">Many Ended Associations</a></li>
<li><a href="#lazyLoading">Lazy Loading</a></li>
</ul>
</li>
<li><a href="#querying">Querying with RxGORM</a>
<ul class="sectlevel2">
<li><a href="#bsonQueries">MongoDB-style Queries</a></li>
</ul>
</li>
<li><a href="#testing">Testing</a></li>
<li><a href="#simpleClient">Simple HTTP Client</a>
<ul class="sectlevel2">
<li><a href="#_sending_receiving_json">Sending &amp; Receiving JSON</a></li>
<li><a href="#_sending_receiving_xml">Sending &amp; Receiving XML</a></li>
</ul>
</li>
<li><a href="#reference">Reference</a>
<ul class="sectlevel3">
<li><a href="#configOptions">Configuration Options</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RxGORM for REST project aims to implement a non-blocking REST client using RxJava, RxNetty and the RxGORM API. RxGORM is an Object mapping technology that has implementations for MongoDB and other databases. In fact RxGORM for REST uses the same Object-to-Document encoding engine used in RxGORM for MongoDB, resulting in high performance encoding and decoding of JSON documents from REST web services.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Currently RxGORM REST Client only supports JSON responses and XML support is not planned at this time.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gettingStarted">Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="installation">Installation</h3>
<div class="paragraph">
<p>RxGORM for REST is designed to be very lightweight, and so can be used in a number of scenarios either standalone or within a Grails application.</p>
</div>
<div class="sect3">
<h4 id="withGrails">Installation with Grails</h4>
<div class="paragraph">
<p>To use RxGORM for REST within a Grails 3 application add the following dependency to your <code>build.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compile 'org.grails.plugins:rx-gorm-rest-client:1.0.3'
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="withoutGrails">Installation without Grails</h4>
<div class="paragraph">
<p>If you are not developing a Grails application then define the following dependency in your <code>build.gradle</code> or <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="title"><code>build.gradle</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile "org.grails:grails-datastore-gorm-rx-rest-client:1.0.3.RELEASE"</code></pre>
</div>
</div>
<div class="paragraph">
<p>With that done you will need to place the following logic in the bootstrap path of your application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.grails.datastore.mapping.core.*</span>
<span class="keyword">import</span> <span class="include">org.grails.datastore.rx.rest.*</span>
...

PropertyResolver configuration = DatastoreUtils.createPropertyResolver(<span class="string"><span class="delimiter">'</span><span class="content">grails.gorm.rest.readTimeout</span><span class="delimiter">'</span></span>:<span class="integer">1500</span>,
                                                                       <span class="string"><span class="delimiter">'</span><span class="content">grails.gorm.rest.host</span><span class="delimiter">'</span></span>:<span class="string"><span class="delimiter">'</span><span class="content">localhost</span><span class="delimiter">'</span></span>)
<span class="keyword">new</span> RxRestDatastoreClient(
            configuration, <i class="conum" data-value="1"></i><b>(1)</b>
            MyClass <i class="conum" data-value="2"></i><b>(2)</b>
)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The configuration. This parameter is optional with the default server being localhost. See <a href="../api/org/grails/datastore/rx/rest/config/Settings.html">Settings</a> for available options.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>One or many classes that implement <a href="../api/grails/gorm/rx/rest/RxRestEntity.html">RxRestEntity</a></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="../api/org/grails/datastore/rx/rest/RxRestDatastoreClient.html">RxRestDatastoreClient</a> class is required to initialize RxGORM for REST.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="creatingDomainClasses">Creating Domain Classes</h3>
<div class="paragraph">
<p>When using RxGORM each entity that you submit to a REST service is known as a domain class.</p>
</div>
<div class="paragraph">
<p>If you are using RxGORM within Grails you can create a domain class with the <code>create-domain-class</code> command provided by the command line. Alternatively if you are not using Grails simply creating a Groovy class within <code>src/main/groovy</code> of your project will suffice.</p>
</div>
<div class="paragraph">
<p>A RxGORM for REST domain class must as a minimum implement the <a href="../api/grails/gorm/rx/rest/RxRestEntity.html">RxRestEntity</a> trait. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are not using Grails and have placed the domain class in <code>src/main/groovy</code> you must also annotate the domain class with the <code>Entity</code> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
import grails.gorm.annotation.*

<span class="annotation">@Entity</span>
<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The type is provided as a generic argument to the <code>RxRestEntity</code> trait. This is important to ensure the correct return signatures are produced for methods provided by the trait.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more information on domain modelling in GORM, take a look at the <a href="http://docs.grails.org/latest/guide/GORM.html#domainClasses">GORM user guide documentation</a> on the subject.</p>
</div>
</div>
<div class="sect2">
<h3 id="crud">Performing CRUD Operations</h3>
<div class="paragraph">
<p>Create, Read, Update and Delete (or CRUD) in REST applications are typically modelled by the HTTP verbs <code>GET</code>, <code>POST</code> and <code>DELETE</code>. The following examples will work you through how to perform each.</p>
</div>
<div class="sect3">
<h4 id="_create_saving_domain_instances">Create - Saving domain instances</h4>
<div class="paragraph">
<p>To create and save a new instance to a REST web service you should use the <code>save()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
        .save()
        .toBlocking()
        .first()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>save()</code> method returns an <a href="http://reactivex.io/RxJava/javadoc/rx/Observable.html">rx.Observable</a>.</p>
</div>
<div class="paragraph">
<p>Notice that in this example we are calling <code>toBlocking()</code>, this is purely for demonstration and testing purposes to ensure the operation completes immediately.</p>
</div>
<div class="paragraph">
<p>In a real world application you would typically subscribe to the observable in order to receive a result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
        .save()
        .subscribe { <span class="predefined-type">Book</span> <span class="local-variable">it</span> -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title = </span><span class="inline"><span class="inline-delimiter">${</span><span class="local-variable">it</span>.title<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you don&#8217;t call <code>subscribe(..)</code> or convert the <code>Observable</code> into a blocking operation, then no query will be executed! At least one call to <code>subscribe(..)</code> is required.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Observable</code> will by default submit to the <code>/book</code> URI using an HTTP <code>POST</code> with a content type of <code>application/json</code> using the following body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can alter both the URI and the <a href="../api/grails/http/MediaType.html">MediaType</a> to submit in the POST request using your domain mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>
<span class="keyword">import</span> <span class="include">grails.http.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> mapping = {
        uri <span class="string"><span class="delimiter">&quot;</span><span class="content">/books{/id}</span><span class="delimiter">&quot;</span></span>
        contentType MediaType.HAL_JSON
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example a URI is specified that makes the <code>POST</code> request submit to <code>/books</code> instead. URIs are specified using the <a href="https://tools.ietf.org/html/rfc6570">RFC 6570 URI Template</a> syntax.</p>
</div>
<div class="paragraph">
<p>The example also alters the <code>MediaType</code> used to instead be <code>application/hal+json</code>. <a href="https://tools.ietf.org/html/draft-kelly-json-hal-08">HAL (Hypertext Application Language)</a> is a draft specification for representing JSON responses in REST applications also supported by Grails' <a href="http://views.grails.org/latest">JSON Views</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_read_retrieving_domain_instances">Read - Retrieving domain instances</h4>
<div class="paragraph">
<p>To retrieve an instance you can use the static <code>get(..)</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(id)
    .subscribe { <span class="predefined-type">Book</span> <span class="local-variable">it</span> -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title = </span><span class="inline"><span class="inline-delimiter">${</span><span class="local-variable">it</span>.title<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>get</code> method will issue an HTTP <code>GET</code> request to the <code>/books/id</code> URI and decode the <code>Book</code> from the JSON response. Both HAL and regular JSON responses are supported. To list all the available books you can use the <code>list()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.list()
    .subscribe { <span class="predefined-type">List</span>&lt;<span class="predefined-type">Book</span>&gt; books -&gt;
    <span class="keyword">for</span>(book <span class="keyword">in</span> books)
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title = </span><span class="inline"><span class="inline-delimiter">${</span>book.title<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To handle errors you can use the RxJava <a href="http://reactivex.io/RxJava/javadoc/rx/Observer.html">Observer</a> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">observable.subscribe(<span class="keyword">new</span> <span class="predefined-type">Observer</span>&lt;<span class="predefined-type">Book</span>&gt;() {
    <span class="annotation">@Override</span>
    <span class="type">void</span> onCompleted() {
        <span class="comment">// when all work is completed</span>
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> onError(<span class="predefined-type">Throwable</span> e) {
        <span class="comment">// when an occur occurs</span>
    }

    <span class="annotation">@Override</span>
    <span class="type">void</span> onNext(<span class="predefined-type">Book</span> book) {
        <span class="comment">// when a book is read</span>
    }
})</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_updating_instances">Update - Updating instances</h4>
<div class="paragraph">
<p>To update an instance after retrieving it you can use the <a href="http://reactivex.io/RxJava/javadoc/rx/Observable.html#switchMap(rx.functions.Func1)">Observable.switchMap</a> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(id)
    .switchMap() { <span class="predefined-type">Book</span> <span class="local-variable">it</span> -&gt;
    <span class="local-variable">it</span>.title = <span class="string"><span class="delimiter">&quot;</span><span class="content">The Shining</span><span class="delimiter">&quot;</span></span>
    <span class="keyword">return</span> <span class="local-variable">it</span>.save()
}.subscribe { <span class="predefined-type">Book</span> updated -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Book updated!</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>switchMap</code> transforms an <code>Observable</code> and converters the result into another <code>Observable</code>.</p>
</div>
<div class="paragraph">
<p>In this example we first retrieve an instance by id which uses an HTTP <code>GET</code> method, then we call <code>save()</code> on that instance which by default will use an HTTP <code>PUT</code> method to the <code>/books/id</code> URI containing the updated JSON body in full.</p>
</div>
<div class="paragraph">
<p>If you want to send only the updated properties JSON you can use the <code>patch()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">book.patch()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The patch method will issue an HTTP <code>PATCH</code> with only the JSON that has changed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some REST web services use <code>POST</code> or <code>PATCH</code> instead of <code>PUT</code> for updates. If you want to configure RxGORM to always use another HTTP method you can set the <code>grails.gorm.rest.updateMethod</code> property in your configuration to the method of your choosing.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_delete_deleting_instances">Delete - Deleting instances</h4>
<div class="paragraph">
<p>To delete an instance after retrieving it you can use the <a href="http://reactivex.io/RxJava/javadoc/rx/Observable.html#switchMap(rx.functions.Func1)">Observable.switchMap</a> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(id)
    .switchMap() { <span class="predefined-type">Book</span> <span class="local-variable">it</span> -&gt;
    <span class="keyword">return</span> <span class="local-variable">it</span>.delete()
}.subscribe { <span class="predefined-type">Boolean</span> wasDeleted -&gt;
    <span class="keyword">if</span>(wasDeleted) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Book deleted!</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example once again will issue an HTTP <code>GET</code> method to retrieve an instance and then an HTTP <code>DELETE</code> method to delete it.</p>
</div>
<div class="paragraph">
<p>If you know ahead of time the identifier of the resource you want to delete you can simply create a new instance and call <code>delete()</code> to issue an HTTP <code>DELETE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>()
book.id = <span class="integer">1L</span>
book.delete().subscribe { <span class="predefined-type">Boolean</span> wasDeleted -&gt;
    <span class="keyword">if</span>(wasDeleted) {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">Book deleted!</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Using the constructor syntax <code>new Book(id:1L)</code> will not work in a Grails application as Grails will prevent binding the id via the constructor for security reasons.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All of the <a href="#configOptions">configuration options</a> for RxGORM for REST can be found within the <a href="../api/org/grails/datastore/rx/rest/config/Settings.html">Settings</a> class.</p>
</div>
<div class="sect2">
<h3 id="_basic_configuration">Basic Configuration</h3>
<div class="sect3">
<h4 id="_server_host">Server Host</h4>
<div class="paragraph">
<p>You can configure the server host to connect to when issuing HTTP requests using the <code>grails.gorm.rest.host</code> setting in <code>grails-app/conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">host</span>: <span class="string"><span class="content">http://localhost:8080</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For environment specific configuration you can nest the configuration within each environment block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">environments</span>:
    <span class="key">development</span>:
        <span class="key">grails</span>:
            <span class="key">gorm</span>:
                <span class="key">rest</span>:
                    <span class="key">host</span>: <span class="string"><span class="content">http://localhost:8080</span></span>
    <span class="key">production</span>:
        <span class="key">grails</span>:
            <span class="key">gorm</span>:
                <span class="key">rest</span>:
                    <span class="key">host</span>: <span class="string"><span class="content">http://myapiserver.com</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_read_timeout">Read Timeout</h4>
<div class="paragraph">
<p>You can configure the default read timeout (in milliseconds) using the <code>grails.gorm.rest.readTimeout</code> setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">host</span>: <span class="string"><span class="content">http://localhost:8080</span></span>
            <span class="key">readTimeout</span>: <span class="string"><span class="content">2000</span></span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wire_logging">Wire Logging</h4>
<div class="paragraph">
<p>To enable RxNetty wire logging you first need to set the log level using the <code>grails.gorm.rest.logLevel</code> setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">host</span>: <span class="string"><span class="content">http://localhost:8080</span></span>
            <span class="key">readTimeout</span>: <span class="string"><span class="content">2000</span></span>
            <span class="key">log</span>:
                <span class="key">level</span>: <span class="string"><span class="content">TRACE</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then ensure your log configuration enables logging for the <code>grails.gorm.rx.rest.logging</code> package. For example in <code>logback.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">logger(<span class="string"><span class="delimiter">&quot;</span><span class="content">grails.gorm.rx.rest.logging</span><span class="delimiter">&quot;</span></span>, TRACE)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="singleHost">Single Host Connection Pooling</h3>
<div class="paragraph">
<p>With a single host configuration RxGORM for REST will create a connection pool for that single host.</p>
</div>
<div class="paragraph">
<p>The connection pool is defined by a <a href="https://github.com/ReactiveX/RxNetty/blob/0.5.x/rxnetty-common/src/main/java/io/reactivex/netty/client/pool/PoolConfig.java">io.reactivex.netty.client.pool.PoolConfig</a> instance.</p>
</div>
<div class="paragraph">
<p>The properties of this instance can configured via the <code>grails.gorm.rest.pool.options</code> property. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">host</span>: <span class="string"><span class="content">http://localhost:8080</span></span>
            <span class="key">pool</span>:
                <span class="key">options</span>:
                    <span class="key">maxConnections</span>: <span class="string"><span class="content">20</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="loadBalanced">Client Side Load Balancing</h3>
<div class="paragraph">
<p>If you wish to use client side load balancing between multiple servers you can use the <code>grails.gorm.rest.hosts</code> option and specify multiple server hosts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">hosts</span>:
                - <span class="string"><span class="content">http://one.myapiserver.com</span></span>
                - <span class="string"><span class="content">http://two.myapiserver.com</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default load balancing strategy is <a href="https://github.com/ReactiveX/RxNetty/blob/0.5.x/rxnetty-http/src/main/java/io/reactivex/netty/protocol/http/client/loadbalancer/EWMABasedP2CStrategy.java">EWMABasedP2CStrategy</a>. If you which to specify an alternate strategy you can do so with the <code>grails.gorm.rest.loadBalanceStrategy</code> property.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="domainClasses">Working with Domain Classes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using RxGORM for REST simple types will be converted to their JSON equivalents during the encoding process. For types that cannot be represented in JavaScript such as <code>BigDecimal</code> these will be converted to a JSON <code>String</code> type.</p>
</div>
<div class="paragraph">
<p>JSON arrays can be represented with the <code>List</code> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; authors
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nested JSON objects can be represented using the <code>Map</code> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; attributes
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="customTypes">Custom Types</h3>
<div class="paragraph">
<p>RxGORM for REST is built ontop of MongoDB&#8217;s JSON encoding framework. This means it is possible to implement custom <a href="http://mongodb.github.io/mongo-java-driver/3.2/bson/codecs">Codecs</a> for encoding and decoding values to and from JSON.</p>
</div>
<div class="paragraph">
<p>For example consider the following simple Groovy class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Birthday</span> {
    <span class="predefined-type">Date</span> date
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default the encoding engine does not know how to represent this type as a JSON value. To make the encoding engine understand this type you have to implement a custom codec:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.bson.*</span>
<span class="keyword">import</span> <span class="include">org.bson.codecs.*</span>

<span class="type">class</span> <span class="class">BirthdayCodec</span> <span class="directive">implements</span> Codec&lt;Birthday&gt; {
    Birthday decode(BsonReader reader, DecoderContext decoderContext) {
        <span class="keyword">return</span> <span class="keyword">new</span> Birthday(<span class="key">date</span>: <span class="keyword">new</span> <span class="predefined-type">Date</span>(reader.readDateTime())) <i class="conum" data-value="1"></i><b>(1)</b>
    }
    <span class="type">void</span> encode(BsonWriter writer, Birthday value, EncoderContext encoderContext) {
        writer.writeDateTime(value.date.time) <i class="conum" data-value="2"></i><b>(2)</b>
    }
    <span class="predefined-type">Class</span>&lt;Birthday&gt; getEncoderClass() { Birthday } <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Decodes the <code>Birthday</code> type from the <code>BsonReader</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Encodes the <code>Birthday</code> type to the <code>BsonWriter</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Returns the type that is to be encoded. In this case <code>Birthday</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With that done you then need to register the custom <code>Codec</code>. There are two ways to achieve this.</p>
</div>
<div class="paragraph">
<p>You can register a list of codecs in the <code>grails.gorm.rest.codecs</code> setting in <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">codecs</span>:
                - <span class="string"><span class="content">my.company.BirthdayCodec</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can create a <code>META-INF/services/org.bson.Codec</code> file containing the class name of the <code>Codec</code></p>
</div>
</div>
<div class="sect2">
<h3 id="identity">Identity Generation</h3>
<div class="paragraph">
<p>By default it is assumed that numeric identifiers will be used for REST resources. This means that when you save an entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
book.save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>A HTTP <code>POST</code> request will be sent to the URI the <code>Book</code> maps to. If the REST endpoint returns JSON then the JSON will be read and the <code>id</code> field populated with the value from the server.</p>
</div>
<div class="paragraph">
<p>If the <code>id</code> of your REST endpoint is not numeric or a different property then you can control that via the <code>mapping</code> block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Entity</span>
<span class="type">class</span> <span class="class">Product</span> <span class="directive">implements</span> RxRestEntity&lt;Product&gt; {

    <span class="predefined-type">String</span> name

    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>, <span class="key">generator</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">assigned</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we have configured the <code>id</code> of the REST resource to be the <code>name</code> property of the entity. Now if you create an entity and save it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Product product = <span class="keyword">new</span> Product(<span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">MacBook</span><span class="delimiter">&quot;</span></span>)
product.save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>RxGORM for REST will send a <code>PUT</code> request to the URI <code>/product/MacBook</code>. This is because RxGORM assumes that if there is an <code>id</code> then what you are trying to do is an update. To instead perform a <code>POST</code> request to the <code>/product</code> URI you must use the <code>insert()</code> method instead which forces saving of a new entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Product product = <span class="keyword">new</span> Product(<span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">MacBook</span><span class="delimiter">&quot;</span></span>)
product.insert()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="uriTemplates">URI Templates</h3>
<div class="paragraph">
<p>As mentioned previously, URIs are specified using the <a href="https://tools.ietf.org/html/rfc6570">RFC 6570 URI Template</a> syntax. A URI template can contain any properties of a domain class. For example consider the following domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title
    <span class="predefined-type">String</span> author

    <span class="directive">static</span> mapping = {
        id <span class="key">name</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>
        uri <span class="string"><span class="delimiter">&quot;</span><span class="content">/authors/{author}/books{/title}</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example when saving the entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span>, <span class="key">author</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>).save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>PUT</code> request will be issued to the URI <code>/authors/Stephen%20King/books/It</code> as the properties of the domain are expanded into the URI template. To issue a <code>POST</code> request you can do:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span>, <span class="key">author</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>).insert()</code></pre>
</div>
</div>
<div class="paragraph">
<p>A <code>POST</code> request will be sent to the URI <code>/authors/Stephen%20King/books</code> or you can choose whichever method you prefer to use with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.HttpMethod.*</span>

<span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span>, <span class="key">author</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>).save(<span class="key">method</span>:PATCH)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To perform a query you can do the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="predefined-type">Book</span>.find {
    title == <span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span> &amp;&amp; author == <span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And a <code>GET</code> request will be issued to <code>/authors/Stephen%20King/books/It</code>.</p>
</div>
<div class="paragraph">
<p>If you wish to alter the URI template for only a single write operation or query you can do so by passing the <code>uri</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// write operation</span>
<span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span>, <span class="key">author</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>).insert(<span class="key">uri</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/authors/{author}/books{/title}</span><span class="delimiter">&quot;</span></span>)

<span class="comment">// query</span>
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="predefined-type">Book</span>.where {
    title == <span class="string"><span class="delimiter">&quot;</span><span class="content">It</span><span class="delimiter">&quot;</span></span> &amp;&amp; author == <span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>
}.find(<span class="key">uri</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/authors/{author}/books{/title}</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="converting">Converting to and from JSON</h3>
<div class="paragraph">
<p>You can convert any domain instance to a JSON string with to <code>toJson()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
println book.toJson()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also pass a <code>java.io.Writer</code> to the method if you wish to write the JSON to a specify target writer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
<span class="predefined-type">StringWriter</span> writer = <span class="keyword">new</span> <span class="predefined-type">StringWriter</span>()
book.toJson(writer)
println writer.toString()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can read an instance from JSON using the <code>fromJson</code> static method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">String</span> json = ...
Book book = <span class="predefined-type">Book</span>.fromJson(json)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A variation of the method accepts a <code>java.io.Reader</code> to read JSON from an alternate source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Reader</span> jsonReader = ...
Book book = <span class="predefined-type">Book</span>.fromJson(jsonReader)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dynamicAttributes">Dynamic Attributes</h3>
<div class="paragraph">
<p>All <code>RxRestEntity</code> instances also implement the <a href="https://gorm.grails.org/6.0.x/api/org/grails/datastore/gorm/schemaless/DynamicAttributes.html">DynamicAttributes</a> trait which allows you to assign arbitrary values to the object using Groovy&#8217;s subscript operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>)
book[<span class="string"><span class="delimiter">'</span><span class="content">pages</span><span class="delimiter">'</span></span>] = <span class="integer">1000</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These will be encoded into the JSON that is sent to the server. Any JSON attributes retrieved from the server that are not declared by the domain class are also available via the subscript operator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">println book[<span class="string"><span class="delimiter">'</span><span class="content">pages</span><span class="delimiter">'</span></span>]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="requestCustomization">Customizing the Request</h3>
<div class="paragraph">
<p>Each method that issues an HTTP request also accepts a <code>Closure</code> which delegates to the <a href="../api/grails/http/client/builder/HttpClientRequestBuilder.html">HttpClientRequestBuilder</a> class and allows customization of the outgoing request. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.HttpHeader.*</span>

<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>).save {
    header ACCEPT_CHARSET, <span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example adds an additional <code>ACCEPT_CHARSET</code> header to the request. The same same technique can be used with static methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.HttpHeader.*</span>

<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="predefined-type">Book</span>.get(<span class="integer">1</span>) {
    header ACCEPT_VERSION, <span class="string"><span class="delimiter">&quot;</span><span class="content">v1.0.0</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another common use case is to add <code>BASIC</code> auth credentials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="predefined-type">Book</span>.get(<span class="integer">1</span>) {
    auth <span class="string"><span class="delimiter">&quot;</span><span class="content">myusername</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">mypassword</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="interceptors">Request Interceptors</h3>
<div class="paragraph">
<p>As an alternative to passing <code>Closure</code> to each invocation you can register <a href="../api/grails/gorm/rx/rest/interceptor/RequestInterceptor.html">RequestInterceptor</a> instances. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.interceptor.*</span>

<span class="type">class</span> <span class="class">AuthInterceptor</span> <span class="directive">extends</span> RequestBuilderInterceptor {
    <span class="annotation">@Override</span>
    Closure build(HttpClientRequest request, InterceptorContext context )
        buildRequest {
            auth <span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">'</span><span class="content">SERVICE_USERNAME</span><span class="delimiter">'</span></span>), <span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">'</span><span class="content">SERVICE_PASSWORD</span><span class="delimiter">'</span></span>)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above the credentials for BASIC auth are ready from environment variables.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you wish to configure BASIC auth environment variables globally you can do so with the <code>grails.gorm.rest.username</code> and <code>grails.gorm.rest.password</code> settings in <code>grails-app/conf/application.yml</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The interceptor can then either be passed as an argument to write operation or query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// write operation with interceptor</span>
book.save(<span class="key">interceptor</span>: <span class="keyword">new</span> AuthInterceptor())

<span class="comment">// query with interceptor</span>
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; o = <span class="predefined-type">Book</span>.get(<span class="integer">1L</span>, [<span class="key">interceptor</span>: <span class="keyword">new</span> AuthInterceptor()])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can register an interceptor globally by defining the <code>grails.gorm.rest.interceptors</code> in <code>grails-app/conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">rest</span>:
            <span class="key">interceptors</span>: <span class="string"><span class="content">example.AuthInterceptor</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or alternatively you can create a <code>META-INF/services/grails.gorm.rx.rest.interceptor.RequestInterceptor</code> file containing the class name of the <code>RequestInterceptor</code> and it will be picked up automatically.</p>
</div>
</div>
<div class="sect2">
<h3 id="batchUpdates">Batch Updates</h3>
<div class="paragraph">
<p>You can perform multiple HTTP write operations (<code>POST</code> or <code>DELETE</code> etc.) by using either the <code>saveAll</code> or <code>deleteAll</code> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// multiple POST operations</span>
<span class="predefined-type">Observable</span> observable = <span class="predefined-type">Book</span>.saveAll(
    <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>),
    <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Shining</span><span class="delimiter">&quot;</span></span>)
)

<span class="comment">// multiple DELETE operations</span>
<span class="predefined-type">Observable</span> observable = <span class="predefined-type">Book</span>.deleteAll(
    book1,
    book2
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>These methods will return an <code>Observable</code> that only completes when all the operations have been successful.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="associations">Modelling Associations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RxGORM for REST supports defining associations between REST endpoints and adds some additional integration with <a href="https://tools.ietf.org/html/draft-kelly-json-hal-08">HAL (Hypertext Application Language)</a> to automatically interpret the HAL <code>_embedded</code> and <code>_links</code> attributes.</p>
</div>
<div class="sect2">
<h3 id="embedded">Embedded</h3>
<div class="paragraph">
<p>Embedded associations are supported for both entity and collection types. Simply declare the assocation as <code>embedded</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    Author author
    <span class="predefined-type">List</span>&lt;Author&gt; otherAuthors

    <span class="directive">static</span> embedded = [<span class="string"><span class="delimiter">'</span><span class="content">author</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">otherAuthors</span><span class="delimiter">'</span></span>]
}

<span class="type">class</span> <span class="class">Author</span> <span class="directive">implements</span> RxRestEntity&lt;Author&gt; {
    <span class="predefined-type">String</span> name
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When JSON is sent back from the server the embedded association will be decoded from the JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>}}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hasOne">Single Ended Associations</h3>
<div class="paragraph">
<p>Single-ended associations can be represented by simply declaring the associated type as a property of the domain class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    Author author
}

<span class="type">class</span> <span class="class">Author</span> <span class="directive">implements</span> RxRestEntity&lt;Author&gt; {
    <span class="predefined-type">String</span> name
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a JSON response is returned that contains only the association id then an <a href="../api/grails/gorm/rx/proxy/ObservableProxy.html">ObservableProxy</a> is returned. For example given the following JSON response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>ObservableProxy</code> that executes a GET request to the <code>/author/1</code> URI will be returned. This allows you to subscribe the association in order to read it lazily:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(<span class="integer">1</span>).subscribe { <span class="predefined-type">Book</span> book -&gt;
    book.author.subscribe { Author author -&gt;
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">got author </span><span class="inline"><span class="inline-delimiter">$</span>author</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to load both the <code>Book</code> and the <code>Author</code> there are a couple of ways to achieve that. One way is to use the <code>switchMap</code> and <code>zip</code> methods to load both in a non-blocking manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(<span class="integer">1</span>).switchMap { <span class="predefined-type">Book</span> book -&gt;
    <span class="predefined-type">Observable</span>.zip( <span class="predefined-type">Observable</span>.just(book), book.author.toObservable()) { <span class="predefined-type">Book</span> b1, Author author -&gt;
        <span class="keyword">return</span> [b1, author]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively a much simpler way is to use an eager query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(<span class="integer">1</span>, [<span class="key">fetch</span>:[<span class="key">author</span>:<span class="string"><span class="delimiter">'</span><span class="content">eager</span><span class="delimiter">'</span></span>]).subscribe { <span class="predefined-type">Book</span> book -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Author </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.author.name</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Conversely if the JSON returned from the server includes the <code>author</code> embedded within the JSON, then no <code>ObservableProxy</code> will be created and instead the association will be loaded fully initialized. For example the following JSON will produce an initialized entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you are using HAL the following JSON will also work:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">_embedded</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span>}},<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can alter the <a href="#uriTemplates">URI Template</a> used by RxGORM to load the association using the <code>mapping</code> block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    Author author

    <span class="directive">static</span> mapping = {
        author <span class="key">uri</span>:<span class="string"><span class="delimiter">'</span><span class="content">/authors/{name}</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above case the <code>name</code> property of the <code>Author</code> will be used to load the association instead. You can also override the URI used to load an association from the server by sending back HAL links:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">author</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/authors/{name}</span><span class="delimiter">&quot;</span></span>},<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case RxGORM will create an <code>ObservableProxy</code> to load the author from the <code>/author/{name}</code> URI template.</p>
</div>
<div class="paragraph">
<p>If you define a single-ended association using the <code>hasOne</code> syntax then the foreign key is assumed to always exist on the inverse side of the association:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> hasOne = [<span class="key">author</span>:Author]
}

<span class="type">class</span> <span class="class">Author</span> <span class="directive">implements</span> RxRestEntity&lt;Author&gt; {
    <span class="predefined-type">String</span> name
    <span class="directive">static</span> belongsTo = [<span class="key">book</span>:<span class="predefined-type">Book</span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case by default a URI template of <code>/book/{book}/author</code> will be created as it is assumed that the <code>/book</code> resource wholly owns the <code>author</code> and therefore it is nested within it. You can alter how the URI maps using the <code>mapping</code> block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> hasOne = [<span class="key">author</span>:Author]

    <span class="directive">static</span> mapping = {
        author <span class="string"><span class="delimiter">'</span><span class="content">/books/{book}/info/author</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Within the <a href="#uriTemplates">URI Template</a> for the association you can include any properties of the <code>Book</code> class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="hasMany">Many Ended Associations</h3>
<div class="paragraph">
<p>Only bidirectional many ended associations are supported. To define an association you can use the <code>hasMany</code> syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> hasMany = [<span class="key">authors</span>:Author]
}

<span class="type">class</span> <span class="class">Author</span> <span class="directive">implements</span> RxRestEntity&lt;Author&gt; {
    <span class="predefined-type">String</span> name
    <span class="directive">static</span> belongsTo = [<span class="key">book</span>:<span class="predefined-type">Book</span>]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case by default a <a href="#uriTemplates">URI template</a> of <code>/book/{book}/authors</code> will be created as it is assumed that the <code>/book</code> resource wholly owns the <code>authors</code> and therefore it is nested within it. You can alter how the URI maps using the <code>mapping</code> block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> hasMany = [<span class="key">authors</span>:Author]

    <span class="directive">static</span> mapping = {
        authors <span class="string"><span class="delimiter">'</span><span class="content">/books/{book}/info/authors</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Within the <a href="#uriTemplates">URI Template</a> for the association you can include any properties of the <code>Book</code> class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When an entity is retrieved all many ended associations are lazy by default and return an instance of <a href="../api/grails/gorm/rx/collection/RxPersistentCollection.html">RxPersistentCollection</a> which allows you to subscribe to the collection to load it in a non-blocking manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.get(<span class="integer">1</span>).subscribe { <span class="predefined-type">Book</span> book -&gt;
    book.authors.subscribe { Author author -&gt;
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">got author </span><span class="inline"><span class="inline-delimiter">$</span>author</span><span class="content">.name</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lazyLoading">Lazy Loading</h3>
<div class="paragraph">
<p>As mentioned previously you can retrieve any lazy association using an eager query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// query by id</span>
<span class="predefined-type">Book</span>.get(<span class="integer">1</span>, [<span class="key">fetch</span>:[<span class="key">authors</span>:<span class="string"><span class="delimiter">'</span><span class="content">eager</span><span class="delimiter">'</span></span>]).subscribe { <span class="predefined-type">Book</span> book -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Authors </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.authors</span><span class="delimiter">&quot;</span></span>
}

<span class="comment">// query an alternative URI</span>
<span class="predefined-type">Book</span>.where {
    title == <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>
}.find(<span class="key">uri</span>:<span class="string"><span class="delimiter">'</span><span class="content">/books/byTitle/{title}</span><span class="delimiter">'</span></span>, <span class="key">fetch</span>:[<span class="key">authors</span>:<span class="string"><span class="delimiter">'</span><span class="content">eager</span><span class="delimiter">'</span></span>])
 .subscribe { <span class="predefined-type">Book</span> book -&gt;
      println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
      println <span class="string"><span class="delimiter">&quot;</span><span class="content">Authors </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.authors</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can however also configure an association to be eager by default:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title

    <span class="directive">static</span> hasMany = [<span class="key">authors</span>:Author]

    <span class="directive">static</span> mapping = {
        authors <span class="key">fetch</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">eager</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, if the server sends back the association embedded within the JSON then no lazy loading is necessary.</p>
</div>
<div class="paragraph">
<p>Finally, some REST APIs support the notion of "resource expansion", for example Grails' <a href="http://views.grails.org/1.1.x/#_rendering_domain_classes">JSON views</a> support an <code>expand</code> request parameter. You can send the <code>expand</code> parameter to the server using the <code>expand</code> argument to any query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// query by id</span>
<span class="predefined-type">Book</span>.get(<span class="integer">1</span>, [<span class="key">expand</span>:<span class="string"><span class="delimiter">'</span><span class="content">authors</span><span class="delimiter">'</span></span>]).subscribe { <span class="predefined-type">Book</span> book -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Authors </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.authors</span><span class="delimiter">&quot;</span></span>
}

<span class="comment">// query an alternative URI</span>
<span class="predefined-type">Book</span>.where {
    title == <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>
}.find(<span class="key">uri</span>:<span class="string"><span class="delimiter">'</span><span class="content">/books/byTitle/{title}</span><span class="delimiter">'</span></span>,[<span class="key">expand</span>:<span class="string"><span class="delimiter">'</span><span class="content">authors</span><span class="delimiter">'</span></span>])
 .subscribe { <span class="predefined-type">Book</span> book -&gt;
      println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
      println <span class="string"><span class="delimiter">&quot;</span><span class="content">Authors </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.authors</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example a parameter called <code>expand</code> will be appended to the request URI in the form <code>?expand=authors</code>. If you which to expand multiple associations then multiple parameters will be added, for example <code>?expand=authors&amp;expand=publisher</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
By default the name of the <code>expand</code> parameter is <code>expand</code> but you can change this by setting <code>grails.gorm.rest.parameters.expand</code> in <code>application.yml</code>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="querying">Querying with RxGORM</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Generally in REST applications the URI is the query. So to formulate queries the most typically pattern is pass the <code>uri</code> argument to the query.</p>
</div>
<div class="paragraph">
<p>For example say we you want to add a query to obtain the latests books. That can be done quite simply by altering the URI passed to the <code>findAll</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title


    <span class="directive">static</span> <span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; latestBooks(<span class="predefined-type">Map</span> arguments = [:]) {
        arguments.uri = <span class="string"><span class="delimiter">&quot;</span><span class="content">/books/latest</span><span class="delimiter">&quot;</span></span>
        <span class="keyword">return</span> findAll(uri)
    }
}

...
Book.latestBooks().subscribe { <span class="predefined-type">Book</span> book -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the REST endpoint is parameterized you can use <a href="#uriTemplates">URI Templates</a> to define the query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example

<span class="keyword">import</span> <span class="include">grails.gorm.rx.rest.*</span>

<span class="type">class</span> <span class="class">Book</span> <span class="directive">implements</span> RxRestEntity&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">String</span> title


    <span class="directive">static</span> <span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; latestBooks(<span class="predefined-type">String</span> category, <span class="predefined-type">Map</span> arguments = [:]) {
        arguments.uri = <span class="string"><span class="delimiter">&quot;</span><span class="content">/books/{category}/latest</span><span class="delimiter">&quot;</span></span>
        <span class="keyword">return</span> where {
            eq <span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>, category
        }.findAll(arguments)
    }
}

...
Book.latestBooks(<span class="string"><span class="delimiter">&quot;</span><span class="content">Fiction</span><span class="delimiter">&quot;</span></span>).subscribe { <span class="predefined-type">Book</span> book -&gt;
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">Title </span><span class="inline"><span class="inline-delimiter">$</span>book</span><span class="content">.title</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example a <code>GET</code> request to <code>/books/Fiction/latest</code> will be produced. You can include any additional parameters not declared in the URI template, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.where {
    eq <span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Fiction</span><span class="delimiter">'</span></span>
    eq <span class="string"><span class="delimiter">'</span><span class="content">foo</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">bar</span><span class="delimiter">'</span></span>
}.findAll(<span class="key">uri</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/books/{category}/latest</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example will produce a <code>GET</code> request to <code>/books/Fiction/latest?foo=bar</code>.</p>
</div>
<div class="paragraph">
<p>You can also control pagination and sorting. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.findAll(<span class="key">max</span>:<span class="integer">10</span>, <span class="key">offset</span>:<span class="integer">10</span>, <span class="key">sort</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>, <span class="key">order</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">desc</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Results in a query such as <code>/books?max=10&amp;offset=10&amp;sort=title&amp;order=desc</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The names of the pagination paremeters are configurable. See the <a href="#configOptions">Configuration Options</a> section for more information.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="bsonQueries">MongoDB-style Queries</h3>
<div class="paragraph">
<p>When using the URI, only "equals" style queries are supported and other conditional operators (greater than, less than etc.) are not supported.</p>
</div>
<div class="paragraph">
<p>If you are implementing a search endpoint you may need more richness in the querying ability. One option to implement this is to use a MongoDB-style BSON query.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Book</span>.where {
    author == <span class="string"><span class="delimiter">&quot;</span><span class="content">Stephen King</span><span class="delimiter">&quot;</span></span> &amp;&amp; pages &gt; <span class="integer">500</span>
}.findAll(<span class="key">queryType</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">bson</span><span class="delimiter">&quot;</span></span>, <span class="key">uri</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">/books/search</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will produce a query to the URI <code>/books/search</code> passing a parameter called <code>q</code> with the following URL encoded JSON:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="string"><span class="delimiter">&quot;</span><span class="content">author:</span><span class="delimiter">&quot;</span></span><span class="error">S</span><span class="error">t</span><span class="error">e</span><span class="error">p</span><span class="error">h</span><span class="error">e</span><span class="error">n</span> <span class="error">K</span><span class="error">i</span><span class="error">n</span><span class="error">g</span><span class="string"><span class="delimiter">&quot;</span><span class="content">, </span><span class="delimiter">&quot;</span></span><span class="error">p</span><span class="error">a</span><span class="error">g</span><span class="error">e</span><span class="error">s</span><span class="string"><span class="delimiter">&quot;</span><span class="content">:{</span><span class="delimiter">&quot;</span></span><span class="error">$</span><span class="error">g</span><span class="error">t</span><span class="string"><span class="delimiter">&quot;</span><span class="content">:500}}</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using MongoDB on the server you can use this to perform a query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.bson.*</span>

<span class="keyword">def</span> <span class="function">search</span>(<span class="predefined-type">String</span> q) {
    <span class="predefined-type">Document</span> query = <span class="predefined-type">Document</span>.parse(params.q)
    respond <span class="predefined-type">Book</span>.collection.find(q)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are not using MongoDB on the server you can use the <code>org.grails.datastore.bson.query.BsonQuery</code> class to parse the query into <code>DetachedCriteria</code> instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.grails.datastore.bson.query.*</span>

<span class="keyword">def</span> <span class="function">search</span>(<span class="predefined-type">String</span> q) {
    DetachedCriteria&lt;<span class="predefined-type">Book</span>&gt; criteria = BsonQuery.parse(<span class="predefined-type">Book</span>, <span class="keyword">new</span> BsonReader(<span class="keyword">new</span> JsonReader(params.q)))
    respond criteria.list()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All <a href="https://docs.mongodb.com/manual/reference/operator/query/">comparison and logical operators from MongoDB</a> are supported.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing">Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RxGORM for REST is designed to be very lightweight, so it is easy to spin up in a unit test. A specialized <code>org.grails.datastore.rx.rest.test.TestRxRestDatastoreClient</code> class exists to help make testing even easier.</p>
</div>
<div class="paragraph">
<p>To use the <code>TestRxRestDatastoreClient</code> in Spock add a field to your Spock specification declared with <code>AutoCleanup</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">spock.lang.*</span>
<span class="keyword">import</span> <span class="include">org.grails.datastore.rx.rest.test.TestRxRestDatastoreClient</span>

<span class="type">class</span> <span class="class">BookSpec</span> <span class="directive">extends</span> Specification {
    <span class="annotation">@AutoCleanup</span> TestRxRestDatastoreClient client

     <span class="type">void</span> setup() {
        client = <span class="keyword">new</span> TestRxRestDatastoreClient(<span class="predefined-type">Book</span>)
     }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>TestRxRestDatastoreClient</code> class with create a test HTTP server running on an ephemeral port.</p>
</div>
<div class="paragraph">
<p>You can then use the test client to create expectations within your test methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.MediaType.*</span>
...

given:<span class="string"><span class="delimiter">&quot;</span><span class="content">A Test Client</span><span class="delimiter">&quot;</span></span>
<span class="keyword">def</span> mock = client.expect { <i class="conum" data-value="1"></i><b>(1)</b>
    uri <span class="string"><span class="delimiter">'</span><span class="content">/book/1</span><span class="delimiter">'</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    accept(JSON) <i class="conum" data-value="3"></i><b>(3)</b>
}
.respond { <i class="conum" data-value="4"></i><b>(4)</b>
    json { <i class="conum" data-value="5"></i><b>(5)</b>
        id <span class="integer">1</span>
        title <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use the <code>expect</code> method to define expectations for the request</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we specify that a <code>uri</code> of <code>/book/1/</code> is expected</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>An HTTP <code>Accept</code> header containing <code>application/json</code> is expected</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Here we define the mocked response from the server using the <code>respond</code> method</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The <code>respond</code> method defines the JSON using <code>StreamingJsonBuilder</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then you can simply use the regular RxGORM API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">when</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">A get request is issued</span><span class="delimiter">&quot;</span></span>
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="predefined-type">Book</span>.get(<span class="integer">1</span>)
<span class="predefined-type">Book</span> book = observable.toBlocking().first()</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally verify the expectations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">then</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The response is correct</span><span class="delimiter">&quot;</span></span>
mock.verify()
book.title == <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For testing JSON requests and responses the <code>toJson</code> method can come in handy. For example to test a <code>POST</code> request you can use an existing instance as test data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.MediaType.*</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">grails.http.HttpMethod.*</span>
...

...

given:<span class="string"><span class="delimiter">&quot;</span><span class="content">A POST request</span><span class="delimiter">&quot;</span></span>
<span class="predefined-type">Book</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>
<span class="keyword">def</span> mock = client.expect {
    uri <span class="string"><span class="delimiter">'</span><span class="content">/book</span><span class="delimiter">'</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    method POST <i class="conum" data-value="3"></i><b>(3)</b>
    json book.toJson() <i class="conum" data-value="4"></i><b>(4)</b>
}
.respond {
    created() <i class="conum" data-value="5"></i><b>(5)</b>
    json { <i class="conum" data-value="6"></i><b>(6)</b>
        id <span class="integer">1</span>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a test instance</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Verify the <code>uri</code> is <code>/book</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Verify the HTTP method is <code>POST</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Verify the JSON sent to the server is the same as the JSON produced from converting the <code>Book</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Respond with an HTTP 201 status of <code>CREATED</code></td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Send the <code>id</code> back as JSON</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then perform a <code>POST</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">when</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">A get request is issued</span><span class="delimiter">&quot;</span></span>
<span class="predefined-type">Observable</span>&lt;<span class="predefined-type">Book</span>&gt; observable = <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>).save()
<span class="predefined-type">Book</span> book = observable.toBlocking().first()</code></pre>
</div>
</div>
<div class="paragraph">
<p>And then verify the expectations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="key">then</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The response is correct</span><span class="delimiter">&quot;</span></span>
mock.verify()
book.id == <span class="integer">1L</span>
book.title == <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="simpleClient">Simple HTTP Client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RxGORM for REST includes a low level client in the form of the <a href="../api/grails/http/client/RxHttpClientBuilder.html">RxHttpClientBuilder</a> class that can be used to fulfill use cases that don&#8217;t warrant the creation of a domain class.</p>
</div>
<div class="paragraph">
<p>The most simple use case for obtaining content can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.http.client.*</span>
...
RxHttpClientBuilder client = <span class="keyword">new</span> RxHttpClientBuilder()
<span class="predefined-type">Observable</span>&lt;RxHttpClientBuilder&gt; p = client.post(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://localhost:8080/foo/bar</span><span class="delimiter">&quot;</span></span>) {
    contentType <span class="string"><span class="delimiter">'</span><span class="content">application/json</span><span class="delimiter">'</span></span>
    json {
        title <span class="string"><span class="delimiter">&quot;</span><span class="content">Ping</span><span class="delimiter">&quot;</span></span>
    }
}
p.toJson().subscribe { <span class="predefined-type">Object</span> json -&gt;
    <span class="keyword">assert</span> json.title == <span class="string"><span class="delimiter">'</span><span class="content">Pong</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using the Grails plugin then you do not need to instantiate a new instance and can instead just autowire the existing instance into your controller:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Autowired</span>
RxHttpClientBuilder httpClient</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_sending_receiving_json">Sending &amp; Receiving JSON</h3>
<div class="paragraph">
<p>To send JSON you can use the <code>json</code> method which uses an instance of Groovy&#8217;s <a href="http://docs.groovy-lang.org/latest/html/api/groovy/json/StreamingJsonBuilder.html">StreamingJsonBuilder</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Observable</span>&lt;HttpClientResponse&gt; p = client.post(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://localhost:8080/foo/bar</span><span class="delimiter">&quot;</span></span>) {
    contentType <span class="string"><span class="delimiter">'</span><span class="content">application/json</span><span class="delimiter">'</span></span>
    json {
        title <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>json</code> method is defined within the <a href="../api/grails/http/client/builder/HttpMessageBuilder.html">HttpMessageBuilder</a> which allows you to build JSON with <code>StreamingJsonBuilder</code> in a variety of ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">json [<span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>] <span class="comment">// a JSON array</span>
json <span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello World</span><span class="delimiter">&quot;</span></span> <span class="comment">// a map</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To read a JSON response use the <code>toJson</code> method property of the <a href="../api/grails/http/client/HttpClientResponse.html">HttpClientResponse</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">p.toJson().subscribe { json -&gt;
    <span class="keyword">assert</span> json.title == <span class="string"><span class="delimiter">'</span><span class="content">Pong</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sending_receiving_xml">Sending &amp; Receiving XML</h3>
<div class="paragraph">
<p>To send XML you can use the <code>xml</code> method which uses an instance of Groovy&#8217;s <a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/xml/StreamingMarkupBuilder.html">StreamingMarkupBuilder</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Observable</span>&lt;HttpClientResponse&gt; p = client.post(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://localhost:8080/foo/bar</span><span class="delimiter">&quot;</span></span>) {
    xml {
        message {
            title <span class="string"><span class="delimiter">&quot;</span><span class="content">Ping</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>xml</code> method is defined within the <a href="../api/grails/http/client/builder/HttpMessageBuilder.html">HttpMessageBuilder</a> class.</p>
</div>
<div class="paragraph">
<p>To read an XML response use the <code>toXml</code> method of the <a href="../api/grails/http/client/HttpClientResponse.html">HttpClientResponse</a>, which returns a Groovy <a href="http://docs.groovy-lang.org/latest/html/api/groovy/util/slurpersupport/GPathResult.html">GPathResult</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">p.toXml().subscribe { GPathResult xml -&gt;
    <span class="keyword">assert</span> xml.message.text() == <span class="string"><span class="delimiter">'</span><span class="content">Pong</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reference">Reference</h2>
<div class="sectionbody">
<div class="sect3">
<h4 id="configOptions">Configuration Options</h4>
<div class="paragraph">
<p>The following configuration options are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails.gorm.rest.host</code> - The default host to connect to</p>
</li>
<li>
<p><code>grails.gorm.rest.hosts</code> - The hosts to connect to in a load balanced configuration</p>
</li>
<li>
<p><code>grails.gorm.rest.charset</code> - The character encoding to use</p>
</li>
<li>
<p>`grails.gorm.rest.readTimeout - The default read timeout</p>
</li>
<li>
<p><code>grails.gorm.rest.logLevel</code> -  The default wire log level</p>
</li>
<li>
<p><code>grails.gorm.rest.updateMethod</code> - The default HTTP method to use for updates. Defaults to PUT</p>
</li>
<li>
<p><code>grails.gorm.rest.pool.options</code> - The configuration options to create the <a href="https://github.com/ReactiveX/RxNetty/blob/0.5.x/rxnetty-common/src/main/java/io/reactivex/netty/client/pool/PoolConfig.java">io.reactivex.netty.client.pool.PoolConfig</a> with (only applicable to single host configurations).</p>
</li>
<li>
<p><code>grails.gorm.rest.username</code> - The username to ues for BASIC auth</p>
</li>
<li>
<p><code>grails.gorm.rest.password</code> - The password to use for BASIC auth</p>
</li>
<li>
<p><code>grails.gorm.rest.interceptors</code> - The <a href="../api/org/grails/datastore/rx/rest/interceptor/RequestInterceptor.html">RequestInterceptor</a> instances to use</p>
</li>
<li>
<p><code>grails.gorm.rest.query.type</code> - The type of query implementation to use. Either "simple" or "bson"</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.order</code> - The name of the parameter used to send the order (descending or ascending) to the server</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.expand</code> - The name of the parameter used to expand nested resources</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.sort</code> - The name of the parameter used to send the property to sort by to the server</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.max</code> - The name of the parameter used to send to restrict the maximum number of results</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.offset</code> - The name of the parameter used to send to provide the offset for pagination</p>
</li>
<li>
<p><code>grails.gorm.rest.parameters.query</code> - The name of the parameter used to send the query when using "bson" query type</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
</div>
</div>
</body>
</html>